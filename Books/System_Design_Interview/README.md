# 가상 면접 사례로 배우는 대규모 시스템

<img src="https://user-images.githubusercontent.com/81678439/212782585-d008e16b-383b-4362-a8b1-3c48f1b8dd95.jpeg" width="400"/>

## 1장 사용자 수에 따른 규모 확장성

## 2장 개략적인 규모 추정

- 예제: 트위터 QPS와 저장소 요구량 추정
  - 가정
    - 월간 능동사용자(MAU, Monthly Active User)는 3억명이다.
    - 50%의 사용자가 트위터를 매일 사용한다.
    - 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
    - 미디어를 포함하는 트윗은 10%정도다.
    - 데이터는 5년간 보관된다.
  - 추정
    - QPS(Query Per Second) 추정치
      - 일간 능동 사용자(DAU, Daily Active User) = 3억(MAU) x 50% = 1.5억 명
      - QPS = 1.5억 x 2트윗 / 24시간 / 3600초 = 150,000,000 * 2 / 24 / 3600 = 3,472.222.. = 약 3,500건
      - 최대 QPS(Peek QPS) = 2 x QPS = 약 7,000
    - 저장소 요구량 추정치
      - 평균 트윗 크기
        - tweet_id: 64byte
        - text: 140byte
        - media: 1MB
      - 일일 미디어 저장소 요구량: 1.5억 x 2 x 10% x 1MB = 30TB
      - 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB x 365 x 5 = 54,750TB = 약 55만PB

- 연습: 특정 커뮤니티 앱 QPS, 저장소 요구량 추정
  - 가정
    - 월간 능동 사용자는 약 20,000명이다.
    - 1/3의 사용자가 매일 게시글을 작성한다.
    - 50%의 사용자가 매일 2개의 댓글을 작성한다.
    - 70%의 게시물과 댓글이 퇴근시간대(18~20시)에 집중된다.
    - 90%의 게시글이 이미지를 포함하며, 평균적으로 5MB안팎의 2.5장의 사진을 업로드한다.
    - 데이터는 1년간 보관한다.
  - 추정
    - QPS(Query Per Second) 추정치
      - 일간 능동 사용자 = 20,000 x 50% = 10,000명
      - QPS = (10,000 x 1/3 + 10,000 x 50% x 2) / 24 / 3600 = 0.154.. = 0 -> 의미없음
      - 최대 QPS = (10,000 x 1/3 + 10,000 x 50% x 2) x 60% / 2 / 3600 = 1.11..
    - 저장소 요구량 추정치
      - 평균 게시물 크기
        - post_id: 64byte
        - title: 140byte
        - content: 3,000byte
        - ...
        - images: 12.5MB
      - 평균 댓글 크기
        - comment_id: 64byte
        - content: 64byte
      - 일일 미디어 요구량: 20,000 x 1/3 x 90% x 12.5MB = 75,000MB = 약 75GB
      - 1년간 미디어를 보관하기 위한 저장소 요구량: 75GB x 365 = 27,375GB = 약 27TB

## 3장 시스템 설계 면접 공략법

## 4장 처리율 제한 장치의 설계

## 5장 안정 해시 설계

## 6장 키-값 저장소 설계

## 7장 분산 시스템을 위한 유일 ID 생성기 설계

## 8장 URL 단축기 설계

## 9장 웹 크롤러 설계

## 10장 알림 시스템 설계

## 11장 뉴스 피드 시스템 설계

## 12장 채팅 시스템 설계

## 13장 검색어 자동완성 시스템

## 14장 유튜브 설계

## 15장 구글 드라이브 설계

## 16장 배움은 계속된다
